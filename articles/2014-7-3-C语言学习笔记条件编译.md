---
title: C语言学习笔记条件编译
date: 2014-07-03 19:48:22
categories:
- C
tags:
- C
- 条件编译
---

有时候，我们希望程序的其中一部分代码只有在**满足一定条件时才进行编译**，否则不参与编译(只有参与编译的代码最终才能被执行)，这就是**条件编译**。和上一篇博客，讲的**宏定义**一样也是**预处理指令**的内容。

<!--more-->

## 基本用法

```c
#if 条件1
 // todo
#elif 条件2
// todo
#else
// todo
#endif
```

- 如果**条件1**成立，那么编译器就会把`#if `与 `#elif`之间的代码编译进去**（注意：是编译进去，不是执行，很平时用的if-else是不一样的）**
- 如果**条件1**不成立、**条件2**成立，那么编译器就会把`#elif `与 `#else`之间的代码编译进去
- 如果**条件1/2**都不成立，那么编译器就会把`#else` 与` #endif`之间的代码编译进去
- 条件编译结束后，要在最后面加一个`#endif`
- `#if` 和 `#elif`后面的条件一般是判断**宏定义**而不是判断变量，因为条件编译是在编译之前做的判断，宏定义也是编译之前定义的，而变量是在运行时才产生的

## 进阶用法

### `#if defined()`和`#if !defined()`的用法 

`#if` 和 `#elif`后面的条件不仅仅可以用来判断宏的值，还可以判断是否定义过某个宏。

```c
#if defined(STU)
    // todo
#endif
```

```c
#if !defined(STU)
    // todo
#endif
```



### `#ifdef`和`#ifndef`的用法同上

```c
#ifdef STU
    // todo
#endif
```

```c
#ifndef STU
    // todo
#endif
```





## 参考文献

- [【C语言】16-预处理指令2-条件编译](https://www.cnblogs.com/mjios/archive/2013/03/20/2971275.html)
- [美]Prate,S. C Primer Plus[M]. 第5版. 云巅工作室，译. 北京：人民邮电出版社，2011.4：60-85.

